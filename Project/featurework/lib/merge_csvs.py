from typing import Any, Union

import pandas as pd
#from pandas import DataFrame
#from pandas.io.parsers import TextFileReader

mypath='/home/nislab3/Desktop/outs/malwaredetection/2000/files2/merged/'

from os import listdir
from os.path import isfile, join
onlyfiles = [f for f in listdir(mypath) if isfile(join(mypath, f))]

result = pd.read_csv(mypath + onlyfiles[0])  # type:
for f in range(1,len(onlyfiles)):
    df = pd.read_csv(mypath+onlyfiles[f])
    result= result.merge(df, on=['hash','class_id'], how='outer')
    print('Merged '+ onlyfiles[f] )

#result = pd.merge(df1, df2, left_index=True, right_index=True, how='outer')
#df.set_index('hash',drop=True,append=False, inplace=False, verify_integrity=False)
#print(df.keys())



mydest=mypath+'merged_out.csv';
result.to_csv(mydest,index=False)